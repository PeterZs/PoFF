#include "DataFile.hpp"

DataFile *DataFile::DATA(new DataFile());

DataFile::DataFile() {
  open = false;

  write_velocities = false;
  write_compressions = false;
  write_times = true;
  write_sound = false;
}

void DataFile::init() {
  if (open) {
    close();
  }
  open = true;
  if (write_velocities) {
    vel_file.open("data/velocity.dat");
    med_vel_file.open("data/velocity_mediane.dat");
    quant_vel_file.open("data/velocity_quantiles.dat");
    all_vel_file.open("data/velocities.dat");
  }
  if (write_compressions) {
    compression_file.open("data/compression.dat");
    nb_compressions_file.open("data/nb_compression.dat");
  }
  if (write_times) {
    time_tris_file.open("data/time_tris.dat");
    time_file.open("data/time.dat");
    nb_tris_file.open("data/nb_tris.dat");
  }
  if (write_sound) {
    sound_file.open("data/nb_sounds.dat");
  }
}

void DataFile::close() {
  if (open) {
    open = false;
    if (write_velocities) {
      vel_file.close();
      med_vel_file.close();
      quant_vel_file.close();
      all_vel_file.close();
    }
    if (write_compressions) {
      compression_file.close();
      nb_compressions_file.close();
    }
    if (write_times) {
      time_tris_file.close();
      time_file.close();
      nb_tris_file.close();
    }
    if (write_sound) {
      sound_file.close();
    }
  }
}
